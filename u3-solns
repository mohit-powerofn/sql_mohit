1)
create table
DEVICES
(TIME DATETIME ,
DEVICE char(2),
CONSUMPTION decimal(4,2)
)
;



2)SELECT TIME,DEVICE  FROM DEVICES GROUP BY DEVICE,
TIME HAVING COUNT(TIME)>1;


3)
with MYTABLE as ( select TIME as minn,row_number() over (partition by HOUR(TIME) order by TI
ME)-MINUTE(TIME) as rowdif from usecase3 where DEVICE='D2') select timestampadd(MINUTE,rowdif-1,minn) from MYTABLE
where rowdif!=1;

4)SELECT DEVICE,SUM(CONSUMPTION) FROM DEVICES GROUP
 BY  HOUR(TIME);
 
 
 
5)SELECT DEVICE,CONSUMPTION FROM DEVICES WHERE CONSUMPTION = (SELECT MAX(CONSUMPTION) FROM DEVICES) GROUP BY DEVICE;

